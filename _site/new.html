<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
<head>

  <title>DogeBell</title>
  <meta charset="UTF-8">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="mobile-web-app-capable" content="yes">
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#1e130c">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'><!-- 
  <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}"> -->
  <link rel="apple-touch-icon-precomposed" href="152.png">
  <link rel="apple-touch-startup-image" href="152.png">
  <!-- Global site tag (gtag.js) - Google Analytics -->  

  <!-- Chrome, Firefox OS, Opera -->
  <meta name="theme-color" content="#4285f4">

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CPMKD94RX9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-CPMKD94RX9');
  </script>

  
  <script type="text/javascript" src="/assets/js/mnemonic.js"></script>
  <script type="text/javascript" src="/assets/js/clipboard.min.js"></script>

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script>

<script>

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyC66wDn6qRnk3woFJsrhJnM3XJXhyoJ-G4",
    authDomain: "dogebell-72965.firebaseapp.com",
    databaseURL: "https://dogebell-72965-default-rtdb.firebaseio.com",
    projectId: "dogebell-72965",
    storageBucket: "dogebell-72965.appspot.com",
    messagingSenderId: "873794835835",
    appId: "1:873794835835:web:bc1822fad59414eb15d9de",
    measurementId: "G-XVZHHH4CE6"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();


function insertWallet(item) {
  
  showModal()

  var db = firebase.firestore();
  db.collection("wallet").add(item)
  .then((docRef) => {
      hideModal()
      //console.log("Document written with ID: ", docRef.id);
      WALLET = docRef.id
      movePageWithParam()
      hideDialog("my-dialog")
      drawWallet()

  })
  .catch((error) => {
      hideModal()
      //console.error("Error adding document: ", error);
  });
}

var LOGIN;

function getWallet(){
  WALLET = getParameterByName("WALLET")
  MNEMONIC = getParameterByName("MNEMONIC")

  if(!MNEMONIC){
    return
  }

  var words = MNEMONIC.split(",")
  var word1 = words[0]
  var word2 = words[1]
  var word3 = words[2]
  //alert(word3)

  if(WALLET == "" || word1 == "" || word2 == "" || word3 == ""){
    showToast("Please fill in all fields")
    return
  }

  var db = firebase.firestore();
  db.collection('wallet').doc(WALLET).get()
  .then((doc) => {
      if (doc.exists) {
      //console.log("Document data:", doc.data());
      
      var mnemonic = doc.data().Mnemonic

        if(word1 == mnemonic[0] && word2 == mnemonic[1] && word3 == mnemonic[2]) {
        LOGIN = true  
        $("#sendButton").show()
        $("#backupButton").show()
        } 
      }
    });
}


function createTransaction(item) {

  //showModal()

  var db = firebase.firestore();

  db.collection("block").add(item)
  .then((docRef) => {
      //hideModal()
      //console.log("Document written with ID: ", docRef.id);
  })
  .catch((error) => {
      //console.error("Error adding document: ", error);
  });

}

function showToast(message){
    ons.notification.toast(message, { timeout: 1000, animation: 'ascend' })
}

function showModal() {
  var modal = document.querySelector('ons-modal');
  modal.show();
  setTimeout(function() {
    modal.hide();
  }, 10000);
}

function hideModal() {
  var modal = document.querySelector('ons-modal');
  modal.hide();
}


</script>
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.css">
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css">
  <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  
  <script type="text/javascript">

    var TOTALDOGE = 1
    var CURRENCY = "USD";
    var UNIT = "$";
    var DOGEPRICE = 0
    var DOGEPRICEFORUSD = 0
    var CURRENTLIST = ["USD","CAD","AUD","EUR","GBP","KRW","CNY","JPY","HKD"]
    var CURRENCYUNIT = ["$","$","$","€","£","₩","¥","¥","$"]
    var MARGINLIST = [-20,-18,-16,-14,-12,-10,-8,-6,-4,-2,0,2,4,6,8,10,12,14,16,18,20]
    var MARGIN = 0;
    var MENU = "Home"
    var WALLET;
    var MNEMONIC;

    //https://api.coingecko.com/api/v3/simple/supported_vs_currencies

    setInterval(function() {
      updateDogePrice();
    }, 30000);

    $(document).ready(function(){

      $(CURRENTLIST).each(function(i,item){
        $("#selectList").append(new Option(CURRENTLIST[i], CURRENTLIST[i]));
      });

      $(MARGINLIST).each(function(i,item){
        $("#fiatSelect").append(new Option(MARGINLIST[i]+"%", MARGINLIST[i]));
      });

      $("#fiatSelect").val(0);

      if(getParameterByName("TOTALDOGE")){
        TOTALDOGE = getParameterByName("TOTALDOGE")
      }

      if(getParameterByName("MARGIN")){
        MARGIN = getParameterByName("MARGIN")
        $("#fiatSelect").val(MARGIN)
      }
      
      if(getParameterByName("CURRENCY")){
        CURRENCY = getParameterByName("CURRENCY")
        $("#selectList").val(CURRENCY)
      }

      if(getParameterByName("MENU")){
        MENU = getParameterByName("MENU")
      }

      if(getParameterByName("MNEMONIC")){
        MNEMONIC = getParameterByName("MNEMONIC")
      }

      if(getParameterByName("WALLET")){
        WALLET = getParameterByName("WALLET")
      }

      UNIT = CURRENCYUNIT[$("#selectList").prop('selectedIndex')]
      
      getDogePrice();
      updateDogePrice();
      radomUpdateDogePrice();

      $("#selectList").change( function() {
        changeDoge();
      });

       $("#fiatSelect").change( function() {
        MARGIN = $("#fiatSelect").val()
        //location.href = window.location.href.split('?')[0] + "?TOTALDOGE="+TOTALDOGE +"&CURRENCY=" + CURRENCY +"&MARGIN=" + MARGIN
        movePageWithParam()
      });

    });

    function changeDoge(){

      var promptForDoge = prompt("How much Dogecoin?", TOTALDOGE);

      if ( promptForDoge == null ||  promptForDoge == "") {
        //TOTALDOGE = parseInt(promptForDoge);
        CURRENCY = $("#selectList").val()
        //location.href = window.location.href.split('?')[0] + "?TOTALDOGE="+TOTALDOGE +"&CURRENCY=" + CURRENCY +"&MARGIN=" + MARGIN
        movePageWithParam()
      } else {
        TOTALDOGE = parseInt(promptForDoge);
        CURRENCY = $("#selectList").val()
        //location.href = window.location.href.split('?')[0] + "?TOTALDOGE="+TOTALDOGE +"&CURRENCY=" + CURRENCY +"&MARGIN=" + MARGIN
        movePageWithParam()
      }
    }

    function movePageWithParam() {

      var baseUrl = window.location.href.split('?')[0]
      var url = new URL(baseUrl);

      if(TOTALDOGE){
        url.searchParams.set("TOTALDOGE", TOTALDOGE)
      }
      if(CURRENCY){
        url.searchParams.set("CURRENCY", CURRENCY)
      }
      if(MARGIN){
        url.searchParams.set("MARGIN", MARGIN)
      }
      if(MENU){
        url.searchParams.set("MENU", MENU)
      }
      if(WALLET){
        url.searchParams.set("WALLET", WALLET)
      }
      if(MNEMONIC){
        url.searchParams.set("MNEMONIC", MNEMONIC)
      }
      //alert(url)
      //location.href = url
      history.replaceState({ data: 'replace' }, '', url);

    }
    

    function movePageWithParamOLD() {

      var baseUrl = window.location.href.split('?')[0]

      if(TOTALDOGE){
        baseUrl = updateQueryStringParameter(baseUrl,"TOTALDOGE",TOTALDOGE)
      }
      if(CURRENCY){
        baseUrl = updateQueryStringParameter(baseUrl,"CURRENCY",CURRENCY)
      }
      if(MARGIN){
        baseUrl = updateQueryStringParameter(baseUrl,"MARGIN",MARGIN)
      }
      if(MENU){
        baseUrl = updateQueryStringParameter(baseUrl,"MENU",MENU)
      }
      if(WALLET){
        baseUrl = updateQueryStringParameter(baseUrl,"WALLET",WALLET)
      }
      if(MNEMONIC){
        baseUrl = updateQueryStringParameter(baseUrl,"MNEMONIC",MNEMONIC)
      }

      //alert(baseUrl)
      location.href = baseUrl
    }

    function updateQueryStringParameter(uri, key, value) {
      var re = new RegExp("([?&])" + key + "=.*?(&|$)", "i");
      var separator = uri.indexOf('?') !== -1 ? "&" : "?";
      if (uri.match(re)) {
        return uri.replace(re, '$1' + key + "=" + value + '$2');
      }
      else {
        return uri + separator + key + "=" + value;
      }
    }
    
    function changeFiat(){
      $("#fiatSelect").focus();
    }

    function getDogePrice(){

      $.get( "https://api.coingecko.com/api/v3/simple/price?ids=dogecoin&vs_currencies=USD", function( data ) {
      
        var firstItem = data[Object.keys(data)[0]];
        firstItem = firstItem[Object.keys(firstItem)[0]]
        //alert(firstItem)
        DOGEPRICEFORUSD = firstItem
      });

      if (MARGIN != 0) {
        DOGEPRICEFORUSD = DOGEPRICEFORUSD + (DOGEPRICEFORUSD * (MARGIN / 100))
      }

    }

    function updateDogePrice(){

      $.get( "https://api.coingecko.com/api/v3/simple/price?ids=dogecoin&vs_currencies="+CURRENCY, function( data ) {

        var firstItem = data[Object.keys(data)[0]];
        firstItem = firstItem[Object.keys(firstItem)[0]]
        //(firstItem)
        DOGEPRICE = firstItem

        if (MARGIN != 0) {
          DOGEPRICE = DOGEPRICE + (DOGEPRICE * (MARGIN / 100))
        }


        $( "#dogeCount" ).html(TOTALDOGE);
        $( "#unit" ).html(UNIT);

        if(CURRENCY == "KRW" || CURRENCY == "JPY"){
          $( "#dogePrice" ).html((TOTALDOGE * DOGEPRICE).toFixed(0));
        }
        else if(CURRENCY == "CNY" || CURRENCY == "HKD"){
          $( "#dogePrice" ).html((TOTALDOGE * DOGEPRICE).toFixed(2));
        }else{
          $( "#dogePrice" ).html((TOTALDOGE * DOGEPRICE).toFixed(4));
        }
      });

    }

    function radomUpdateDogePrice() {

      setInterval(function() {


        if (DOGEPRICEFORUSD == 0){
          return
        }

      //console.log(MOONCOST);

      if(CURRENCY == "KRW"){
        var randomValue = Math.random() * 1
          //console.log(randomValue)

          dogeRandomPrice = DOGEPRICE + randomValue

          if(MOONCOST > 0){
            dogeRandomPrice = (DOGEPRICE * MOONCOST) / DOGEPRICEFORUSD
          }

          $( "#dogeCount" ).html(TOTALDOGE);
          $( "#unit" ).html(UNIT);

          $( "#dogePrice" ).html((TOTALDOGE * dogeRandomPrice).toFixed(0));

        }
        else if(CURRENCY == "JPY"){
          var randomValue = Math.random() * 1
          //console.log(randomValue)

          dogeRandomPrice = DOGEPRICE + randomValue

          if(MOONCOST > 0){
            dogeRandomPrice = (DOGEPRICE * MOONCOST) / DOGEPRICEFORUSD
          }
          $( "#dogeCount" ).html(TOTALDOGE);
          $( "#unit" ).html(UNIT);

          $( "#dogePrice" ).html((TOTALDOGE * dogeRandomPrice).toFixed(0));
        }
        else if(CURRENCY == "CNY" || CURRENCY == "HKD"){
          var randomValue = Math.random() * 0.1
        //console.log(randomValue)
        dogeRandomPrice = DOGEPRICE + randomValue

        if(MOONCOST > 0){
            dogeRandomPrice = (DOGEPRICE * MOONCOST) / DOGEPRICEFORUSD
        }
        $( "#dogeCount" ).html(TOTALDOGE);
        $( "#unit" ).html(UNIT);

        $( "#dogePrice" ).html((TOTALDOGE * dogeRandomPrice).toFixed(2));
      }else{
        var randomValue = Math.random() * 0.001

        dogeRandomPrice = DOGEPRICE + randomValue

        if(MOONCOST > 0){
            dogeRandomPrice = (DOGEPRICE * MOONCOST) / DOGEPRICEFORUSD
        }

        $( "#dogeCount" ).html(TOTALDOGE);
        $( "#unit" ).html(UNIT);

        $( "#dogePrice" ).html((TOTALDOGE * dogeRandomPrice).toFixed(4));
      }
    }, 300);
    }

    function getParameterByName(name, url = window.location.href) {
      name = name.replace(/[\[\]]/g, '\\$&');
      var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
      results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    var MOONCOST = 0;

    function toTheMoon(){

      $("#moonPic").fadeIn();

      MOONCOST = DOGEPRICEFORUSD + (MOONCOST  * 0.1);

      if (MOONCOST >1){
        MOONCOST = 1
      }

      setTimeout(function(){
        $("#moonPic").fadeOut()
        MOONCOST = 0;
        getDogePrice();
        updateDogePrice();
      },5000);
    }


ons.disableAutoStyling()
ons.platform.select('ios')
// conosole.log(navigator.userAgent)

// if (ons.platform.isIPhoneX()) { // Utility function
//   // Add empty attribute to the <html> element
//   document.documentElement.setAttribute('onsflag-iphonex-portrait', '');
// }

// document.documentElement.removeAttribute('onsflag-iphonex-portrait');

// if (ons.platform.isIPhoneX()) { // Utility function
//   // Add empty attribute to the <html> element
//   document.documentElement.setAttribute('onsflag-iphonex-landscape', '');
// }

var CURRENTPAGE = 0

//page init
document.addEventListener('init', function(event) {
 //console.log('This is a lifecycle event!', event.target.id);

if (ons.platform.isIPhoneX()) { // Utility function
  // Add empty attribute to the <html> element
//  alert("iPhoneX")
  $(".tabbar").height("70px")
}

var page = event.target.id

MENU = getParameterByName("MENU")

if(!MENU){
  MENU = "Home"
}

if(MENU == "Home" && page == "home"){

  drawChart()

  document.querySelector('ons-tabbar').setActiveTab(0)
}
if(MENU == "Wallet" && page == "wallet"){
  document.querySelector('ons-tabbar').setActiveTab(1)
}
if(MENU == "Mining" && page == "mine"){
  document.querySelector('ons-tabbar').setActiveTab(2)
}
if(MENU == "Trade" && page == "trade"){
  document.querySelector('ons-tabbar').setActiveTab(3)
}

});
//page change
document.addEventListener('postchange', function(event) {
 var selectedIndex = document.querySelector('ons-tabbar').getActiveTabIndex()
 
//console.log(selectedIndex)
// console.log(history.state)
CURRENTPAGE = selectedIndex

if (selectedIndex == 0) {
  //alert("HOME")
  drawChart()
} 
if (selectedIndex == 1) {
  loadBalance();
  drawWallet()
} 
if (selectedIndex == 2) {
  loadBalance();
  drawMine()
} 
if (selectedIndex == 3) {
  loadBalance();
  drawTrade()
} 

});

function copyToClipboard(val) {
  const t = document.createElement("textarea");
  document.body.appendChild(t);
  t.value = val;
  t.select();
  document.execCommand('copy');
  document.body.removeChild(t);
}
function copyAddress() {
  var address = $("#address").val()
  copyToClipboard(address);
  showToast("Address is copied.")
}

function drawWallet(){

WALLET = getParameterByName("WALLET")

if(WALLET){

  getWallet();

  //alert(WALLET)
  $("#address").val(WALLET)
  var addressQRURL = "https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=" + WALLET
  $("#addressQR").attr("src",addressQRURL)
  $("#walletLayout").show() 
  //$("#walletLayout").css("display","block")
  $("#dogebellAmount").html(TOTALAMOUNT + MININGBELL)
  $("#bellTransaction").html(TOTALTRANSACTION)

  QR = getParameterByName("QR")
  if(QR) {
    showSendDogeBell()
  }

}else{
  $("#walletLayout").hide()
  //$("#walletLayout").css("display","none")
  showWalletAlert()
}

}

function drawMine(){
  $("#mineLayout").show() 
  $("#miningBell").html(TOTALAMOUNT + MININGBELL + " BELL")
}

var MININGBELL = 0;

setInterval(function() {

if(CURRENTPAGE!=2){
  //console.log("NOT MINE.")
  return
}

$("#bell").addClass("bell-on")
$("#bell").removeClass("bell-off")
$("#bellEffect").hide()
  
setTimeout(function() {
  $("#bell").addClass("bell-off")
  $("#bell").removeClass("bell-on")
  MININGBELL =  MININGBELL + 1;
  $("#miningBell").html(TOTALAMOUNT + MININGBELL + " BELL")
  $("#bellEffect").show()
  
  // if(MININGBELL > 9){
  //   mineBell()
  // }

  },3000);

},5000);

function drawChain(){
  $("#chainLayout").show() 
}

function createWallet(){

    m = new Mnemonic(32);
    var mnemonic =  m.toWords();
    MNEMONIC = mnemonic
    var insertData = {"Mnemonic" : mnemonic}
    insertWallet(insertData)

}

function importWallet(){
  showMnemonicDialog();
}

function createWalletWithMnemonic(){

  var address = $("#walletInput").val()
  var word1 = $("#word1").val().trim()
  var word2 = $("#word2").val().trim()
  var word3 = $("#word3").val().trim()

  if(address == "" || word1 == "" || word2 == "" || word3 == ""){
    showToast("Please fill in all fields")
    return
  }

  showModal()

  var db = firebase.firestore();
  db.collection('wallet').doc(address).get()

  .then((doc) => {
      hideModal()
      if (doc.exists) {
          //console.log("Document data:", doc.data());
          var mnemonic = doc.data().Mnemonic

          if(word1 == mnemonic[0] && word2 == mnemonic[1] && word3 == mnemonic[2]) {
            WALLET = address
            MNEMONIC = word1+","+word2+","+word3
            movePageWithParam()
          }else{
            document.getElementById('mnemonicDialog').hide()
            showToast("Mnemonic is wrong.")
          }
      } else {
          // doc.data() will be undefined in this case
          console.log("No such document!");
          document.getElementById('mnemonicDialog').hide()
          showToast("Wallet address is wrong.")
          return;
      }
  }).catch((error) => {
      hideModal()
      document.getElementById('mnemonicDialog').hide()
      console.log("Error getting document:", error);
      showToast("Something is wrong.")
      return;
  });
}

function sendDogeBell(){

  var address = $("#sendWalletInput").val()
  var amount = $("#sendInput").val().trim()

  // if(address == "" || amount == "" ){
  //   showToast("Please fill in all fields")
  //   return
  // }

  // if(isNaN(amount)){
  //   showToast("Amount must be a number.")
  //   return
  // }

  // if(amount <= 0){
  //   showToast("Amount must be a positive number.")
  //   return
  // }


  // if(amount > (TOTALAMOUNT + MININGBELL)){
  //   showToast("You hane no DogeBell to send.")
  //   return
  // }

  //showModal()
  
  var insertData = {}
  insertData.from = WALLET
  insertData.to = address
  insertData.amount = amount

  var transactionList = getCookie("transactionList")
  
  if(transactionList){
    transactionList = JSON.parse(transactionList)
  }else{
    transactionList = []
  }


  transactionList.push(insertData)
  transactionList = JSON.stringify(transactionList)
  setCookie("transactionList",transactionList)

  showToast("Sending is success.")
  document.getElementById('sendDialog').hide()

  // var db = firebase.firestore();

  // db.collection("transaction").add(insertData)
  // .then((docRef) => {
  //     hideModal()
  //     showToast("Sending is success.")
  //     document.getElementById('sendDialog').hide()
  //     //console.log("Document written with ID: ", docRef.id);
  // })
  // .catch((error) => {
  //     //console.error("Error adding document: ", error);
  //     hideModal()
  //     showToast("Something is wrong.")
  //     document.getElementById('sendDialog').hide()
  // });
}

var isBuying = false

function buy(){

  if(0 >= TOTALMONEY){
    showToast("You hane no money to buy.")
    return
  }

  isBuying = true
  
  var insertData = {}
  insertData.from = "TRADE"
  insertData.to = WALLET
  insertData.money = TOTALMONEY.toFixed(4)
  insertData.amount = (TOTALMONEY / BELLPRICEFORUSD).toFixed(0)

  TOTALMONEY = 0
  TOTALAMOUNT = (TOTALMONEY / BELLPRICEFORUSD).toFixed(0)
  
  var transactionList = getCookie("transactionList")
  
  if(transactionList){
    transactionList = JSON.parse(transactionList)
  }else{
    transactionList = []
  }

  transactionList.push(insertData)
  transactionList = JSON.stringify(transactionList)
  setCookie("transactionList",transactionList)

  showToast("(BUY PRICE : $"+ BELLPRICEFORUSD +")")
  isBuying = false

  // showModal()
  // var db = firebase.firestore();

  // db.collection("transaction").add(insertData)
  // .then((docRef) => {
  //     hideModal()
  //     showToast("(BUY PRICE : $"+ BELLPRICEFORUSD +")")
  //     isBuying = false
  //     //console.log("Document written with ID: ", docRef.id);
  // })
  // .catch((error) => {
  //     hideModal()
  //     //console.error("Error adding document: ", error);
  //     showToast("Something is wrong.")
  //     isBuying = false
      
  // });
}

var isSelling = false

function sell(){

  if(0 >= (TOTALAMOUNT + MININGBELL)){
    showToast("You hane no DogeBell to sell.")
    return
  }

  isSelling = true

  var insertData = {}
  insertData.from = WALLET
  insertData.to = "TRADE"
  insertData.money = (BELLPRICEFORUSD * (TOTALAMOUNT + MININGBELL)).toFixed(4)
  insertData.amount = TOTALAMOUNT + MININGBELL

  TOTALMONEY  = BELLPRICEFORUSD * (TOTALAMOUNT + MININGBELL)
  TOTALAMOUNT = 0
  MININGBELL = 0


  var transactionList = getCookie("transactionList")
  
  if(transactionList){
    transactionList = JSON.parse(transactionList)
  }else{
    transactionList = []
  }

  transactionList.push(insertData)
  transactionList = JSON.stringify(transactionList)
  setCookie("transactionList",transactionList)

  showToast("(SELL PRICE : $"+ BELLPRICEFORUSD +")")
  isSelling = false

  // var db = firebase.firestore();

  // showModal()
  // db.collection("transaction").add(insertData)
  // .then((docRef) => {
  //     hideModal()
  //     showToast("(SELL PRICE : $"+ BELLPRICEFORUSD +")")
  //     isSelling = false
  //     //console.log("Document written with ID: ", docRef.id);
  // })
  // .catch((error) => {
  //     hideModal()
  //     //console.error("Error adding document: ", error);
  //     isSelling = false
  //     showToast("Something is wrong.")
      
  // });
}

// isInteger는 es6 임. ie 11 에서는 안되므로 함수 만듬.
Number.isInteger = Number.isInteger || function(value) {
    return typeof value === "number" && 
        isFinite(value) && 
        Math.floor(value) === value;
};

var TOTALAMOUNT = 0;
var TOTALTRANSACTION = 0;
var TOTALSUPPLY = 0;

var isUpdate = false
// Loads chat messages history and listens for upcoming ones.
function loadBalance() {

    if(isBuying || isSelling){
      return
    }

    //alert("loadBalance")
    //console.log("CHANGED.")

    if(!WALLET) {
      $("#dogebellAmount").html("0")
      $("#bellTransaction").html("0")
      return;
    }

    // var db = firebase.firestore();
    // var transaction = db.collection("transaction");

    WALLET = getParameterByName("WALLET")


    TOTALAMOUNT = 0;
    TOTALTRANSACTION = 0;
    TOTALMONEY = 0;
    //$("#dogebellAmount").html("0")
    //$("#bellTransaction").html("0")

    isUpdate = true


    var transactionList = getCookie("transactionList")
    
    if(transactionList){
      transactionList = JSON.parse(transactionList)
    }else{
      transactionList = []
    }

    for(i in transactionList) {
      var transaction = transactionList[i]

      if(transaction.to == WALLET) {

            TOTALAMOUNT += parseInt(transaction.amount)
            TOTALTRANSACTION += 1

            var sendMoney = transaction.money

            if(isNaN(sendMoney) == false){
              TOTALMONEY -= parseFloat(sendMoney)
              //console.log("SELL >>" + parseFloat(sendMoney))
            }
      }

      if(transaction.from == WALLET) {

            TOTALAMOUNT -= parseInt(transaction.amount)
            TOTALTRANSACTION += 1

            var buyMoney = transaction.money

            if(isNaN(buyMoney) == false){
              TOTALMONEY += parseFloat(buyMoney)
              //console.log("SELL >>" + parseFloat(sendMoney))
            }
      }
    }

    isUpdate = false
    //alerr TOTALAMOUNT)
    if (TOTALAMOUNT < 0){
      TOTALAMOUNT = 0
    }

    if (TOTALMONEY < 0){
      TOTALMONEY = 0
    }

    refreshScreen();
    return; //For Loop.
}

setInterval(function() {
  loadBalance()

  if(MININGBELL > 0){
    mineBell()
  }
}, 1000) ;

function mineBell(){

  if(!WALLET) {
    showToast("Create a wallet to mine.")
    return
  }

  //howModal()
  var insertData = {}
  insertData.from = "ORIGIN"
  insertData.to = WALLET
  insertData.amount = MININGBELL

  MININGBELL = 0

  var db = firebase.firestore();

  var transactionList = getCookie("transactionList")
  
  if(transactionList){
    transactionList = JSON.parse(transactionList)
  }else{
    transactionList = []
  }


  transactionList.push(insertData)
  transactionList = JSON.stringify(transactionList)
  setCookie("transactionList",transactionList)
}


function refreshScreen(){
  if (CURRENTPAGE == 0) {
    //alert("HOME")
    //drawChart()
  } 
  if (CURRENTPAGE == 1) {
    drawWallet()
  } 
  if (CURRENTPAGE == 2) {
    drawMine()
  } 
  if (CURRENTPAGE == 3) {
    //drawTrade()
  } 
}

function goTelegram(){
  location.href = "https://t.me/dogebellcom"
}


function goQR(){
  var encodedUrl = encodeURIComponent(window.location.href);
  var QRURL = "./qr" + "?RETURNURL=" + encodedUrl
  location.href = QRURL
}

function goHome(){
  MENU = "Home"
  movePageWithParam()
}
function goWallet(){
  MENU = "Wallet"
  movePageWithParam()
  
}
function goMining(){
  MENU = "Mining"
  movePageWithParam()
  
}
function goBlockChain(){
  MENU = "BlockChain"
  movePageWithParam() 
}

function goTrade(){
  MENU = "Trade"
  movePageWithParam()
} 

function showToast(message){
    ons.notification.toast(message, { timeout: 1000, animation: 'fall' })
}

  </script>

  <link rel="stylesheet" href="/assets/css/dojichart.css"/>
  <style>

    .box {
      width: 360px;
      border: 6px solid #ddd;
      border-radius: 6px;
    }

    .moonButton {
      background-color: #f8f9fa;
      border: 1px solid #f8f9fa;
      border-radius: 4px;
      color: #3c4043;
      font-family: 'Apple SD Gothic Neo',arial,sans-serif;
      font-size: 14px;
      margin: 11px 4px;
      padding: 0 16px;
      line-height: 27px;
      height: 36px;
      min-width: 54px;
      text-align: center;
      cursor: pointer;
      user-select: none;
    }

    #particles-js {
      position: absolute;
      width: 100%;
      height: 100%;
      background-color: #ffffff;
      background-image: url("");
      background-repeat: no-repeat;
      background-size: cover;
      background-position: 50% 50%;
      z-index: -1000
    }

    body {margin:0;padding:0;}
    /* where margin-left = {img width}/2, and margin-top= {img height}/2 */
    .bigdiv {
     width:100%;
     height:auto;
     position:absolute;
     z-index: 99999;
     //max-width: 500px;
   }
   .bigdiv img {
    //position:absolute;
    width: 100%;
    height: auto;
    max-width: 500px;
    z-index: 99999;
  }

</style>


<style>

body {
  background-color: #696969;
}  
.page {
max-width: 500px;
margin:0 auto;
}

.dialog{
    width: auto;
    max-width: 90%;
}

.dialog {//min-height:350px;}
#iput-dialog {min-height:200px;}
#inform-dialog {min-height:100px;}

.action-sheet {
  max-width: 500px;
  /  left: 15%;
  //  right: 15%;
}

ons-input, ons-radio, ons-checkbox, ons-search-input {
    display: block;
}

.page__background {
  background-color: #FFFFFF;

}

.speed-dial.fab--bottom__right, button.fab--bottom__right, ons-fab.fab--bottom__right {
  bottom: 40px;
}

</style>
<style>
.footer {
  position: fixed;
  left: 0;
  bottom: 0;
  width: 100%;
  background-color: #A9A9A9;
  text-align: center;
}

.footer_div {
  max-width: 500px;
  background-color: #ffffff;
  padding-top: :10px;
  padding-bottom: 10px;
}


</style>

<script type="text/javascript" src="/assets/js/dojichart.js"></script>

</head>
<body>


<ons-page>  

  <ons-tabbar position="auto" animation="none">
    <ons-tab onClick="goHome()" label="Home" icon="fa-home" page="home.html">
    </ons-tab>
    <ons-tab onClick="goWallet()" label="Wallet" icon="fa-wallet" page="wallet.html">
    </ons-tab>
    <ons-tab onClick="goMining()" label="Mining" icon="fa-mountain" page="mine.html">
    </ons-tab>
    <ons-tab onClick="goTrade()" label="Trade" icon="fa-balance-scale" page="trade.html" >
    </ons-tab>
<!--     <ons-tab onClick="goBlockChain()" label="BlockChain" icon="fa-dice-d20" page="chain.html">
    </ons-tab>
 -->    
  </ons-tabbar>
</ons-page>

<template id="home.html">
  <ons-page id="home">

  <div id="homeLayout" style="display: none">

  <div id="moonPic" class="bigdiv" style="display: none">
    <center>
      <br><br><br><br>

      <img src="/assets/img/tothemoon.png" />
    </center>
  </div>

  <center>


    <div style="line-height:100%;">
     <br>
     <a href="/" >
       <img src="/assets/img/dogebell-title.png" width="70%" height="50%" style="max-width: 500px;">
     </a>

     <h3><a href="#" onClick="changeDoge(); return false;"> <span id="dogeCount">1</span> Dogecoin </a> = <a href="#" onClick="changeFiat(); return false;"><span id="unit">$</span> <span id="dogePrice"></span></a> </h3> 
     <br>

     <div class="custom-select">
       Currency : <select id="selectList">
       </select>
       &nbsp;&nbsp; Margin :
       <select id="fiatSelect">
       </select>
     </div>

     <br>

   </div>

   <div class="box">
    <div class="dojichart" id="my-dojichart">
      <div class="region" data-name="price"></div>
    </div>
  </div>

  <br>
  <input onClick="toTheMoon()" value="To The Moon!" aria-label="To The Moon!" name="btnK" type="button">


  </center>

  <ons-speed-dial position="bottom right" direction="up">
    <ons-fab>
      <ons-icon onClick="goTelegram()" icon="fa-telegram-plane"></ons-icon>
    </ons-fab>
<!--     <ons-speed-dial-item>
      <ons-icon icon="md-twitter"></ons-icon>
    </ons-speed-dial-item>
    <ons-speed-dial-item>
      <ons-icon icon="md-facebook"></ons-icon>
    </ons-speed-dial-item>
    <ons-speed-dial-item>
      <ons-icon icon="md-google-plus"></ons-icon>
    </ons-speed-dial-item> -->
  </ons-speed-dial>



<footer class="site-footer" style="margin: 20px;">

  <center>
    <span class="site-footer-credits">© 2021 <a href="https://dogebell.com">DogeBell.com</a> ALL RIGHTS RESERVED.</span>

    <div>
      <span style="">Donation : </span>
      <a href="https://dogechain.info/address/DN7WNoyLx6DRoQpuzpcLhV95vLARFdbZ9A" target='_blank' >
        <img style="vertical-align:middle" src="/assets/img/dogeaccept.png" width="80px" height="auto">
      </a>
      <a href="https://www.paypal.me/dogebell" target='_blank'>
        <img style="vertical-align:middle" src="/assets/img/paypal.png" width="70px" height="auto">
      </a>

    </div>

  </center>

</footer>


  </div>

  </ons-page>
</template>

<template id="wallet.html">
  <ons-page id="wallet">

<div style="margin-top: 44px; display: none" id="walletLayout">

  <ons-toolbar>
    <div class="center">Wallet</div>
  </ons-toolbar>

  <ons-card style="margin: 20px;" id="walletCard">
    <center>
    <img id="addressQR" src="https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=NULL" alt="Onsen UI" style="width: 50%">
<br>

    <ons-input modifier="underbar" placeholder="Wallet Address" id="address">
      <input id="inputAddress" type="text" class="text-input text-input--underbar" placeholder="Wallet Address"  style="text-align: center;">
      <span class="text-input__label text-input--underbar__label text-input--material__label--active">Wallet Address</span>
    </ons-input>

<br>
      <div>
        <ons-button id="sendButton" style="display: none" onClick="showSendDogeBell()"><ons-icon icon="fa-paper-plane"></ons-icon>&#x20;Send</ons-button>&#x20;
        <ons-button onClick="copyAddress()" id="copyButton" data-clipboard-text="AAAA"><ons-icon icon="fa-copy"></ons-icon>&#x20;Copy</ons-button>&#x20;
        <ons-button id="backupButton" style="display: none"  onClick="showMnemonicBackupDialog()"><ons-icon icon="file-export"></ons-icon>&#x20;Backup</ons-button>&#x20;
      </div>
<br>      
    </center>
    <div class="content">
      <ons-list>
        <ons-list-header>Information</ons-list-header>
        <ons-list-item>Amount &nbsp;:&nbsp; <span id="dogebellAmount"></span>&nbsp;BELL</ons-list-item>
        <ons-list-item>Transaction &nbsp;:&nbsp; <span id="bellTransaction"></span></ons-list-item>
      </ons-list>
    </div>
  </ons-card>
</ons-page>
</template>

<template id="action-sheet.html">

  <center>
  <ons-action-sheet id="sheet" cancelable title="You do not have a wallet.">
    <ons-action-sheet-button icon="md-square-o" onClick="app.hideFromTemplate()">Create Wallet.</ons-action-sheet-button>
    <ons-action-sheet-button icon="md-square-o" onClick="app.hideFromTemplate()">Import Wallet.</ons-action-sheet-button>
    <ons-action-sheet-button icon="md-close" onClick="app.hideFromTemplate()" modifier="destructive">Cancel</ons-action-sheet-button>
  </ons-action-sheet>
  </center>
</template>

<template id="trade.html">
  <ons-page id="trade">

  <div id="tradeLayout" style="display: none">

  <div id="effectPic" class="bigdiv" style="display: none">
    <center>
      <br><br><br><br>

      <img src="/assets/img/tothemoon.png" />
    </center>
  </div>

  <center>

  <ons-toolbar>
    <div class="center">Trade</div>
  </ons-toolbar>

<br>
<br>
<br>

    <div style="line-height:100%;">
     <h3> 1 DogeBell </a> =  $<span id="bellPrice"></span></a> </h3> 
     <br>
   </div>

   <div class="box">
    <div class="dojichart" id="tradeChart">
      <div class="region" data-name="price"></div>
    </div>
  </div>

  <br>

    <div class="content" style="margin: 10px;">
      <ons-list>
        <ons-list-header>Information</ons-list-header>
        <ons-list-item>My BELL &nbsp;:&nbsp; <span id="dogeBellForTrade"></span>&nbsp;BELL ($<span id="calculateForTrade"></span>)</ons-list-item>
        <ons-list-item>My MONEY &nbsp;:&nbsp; $&nbsp; <span id="moneyForTrade"></span>&nbsp;</ons-list-item>
      </ons-list>
    </div>
 
 <br>

      <div>
      <ons-button onClick="buy()" style="background-color: red; color: white; width: 150px;margin: : 20px;"><ons-icon icon="fa-bell"></ons-icon>&nbsp;&nbsp;Buy BELL&nbsp;&nbsp;</ons-button>
      <ons-button onClick="sell()" style="background-color: blue; color: white; width: 150px;margin: 20px;"><ons-icon icon="fa-bell"></ons-icon>&nbsp;&nbsp;Sell BELL&nbsp;&nbsp;</ons-button>
      </div>

  </center>
  </center>

  </div>

  </ons-page>
</template>

<template id="chain.html">
  <ons-page id="chain">

<div style="margin-top: 44px; display: none" id="chainLayout">
  <ons-toolbar>
    <div class="center">BlockChain</div>
  </ons-toolbar>

  <ons-list>
      <ons-list-item class="input-items">
        <label class="center">
        <ons-search-input id="search-input" maxlength="20" placeholder="Search" onchange="ons.notification.alert('Searched for: ' + this.value)" style="width: 100%;"></ons-search-input>
      </label>
      </ons-list-item>

    <ons-list-item>Item 0</ons-list-item>
    <ons-list-item>Item 2</ons-list-item>
    <ons-list-item>Item 3</ons-list-item>
    <ons-list-item>Item 4</ons-list-item>
    <ons-list-item>Item 5</ons-list-item>
    <ons-list-item>Item 6</ons-list-item>
  </ons-list>

</div>
<!--   <ons-list style="width : 100%;height: 100%;">
    <ons-lazy-repeat id="infinite-list" style="width : 100%;height: 100%;"></ons-lazy-repeat>
  </ons-list> -->
</ons-page>
</template>

<style type="text/css">
//  body {
//  background: #1b1b1b;
//}

h1{
  font-family: tahoma;
  //margin-top: 50px;
  font-size: 48px;
  color: #9e9e9e;
  text-align: center;
  font-weight: 200;
}

.bell-off{

  display:block;
  width: 140px;
  height: 140px;
  font-size: 140px;
  margin:50px auto  50px auto ;
  color: #9e9e9e;
  //-webkit-animation: ring 5s .7s ease-in-out infinite;
  -webkit-transform-origin: 50% 4px;
  //-moz-animation: ring 5s .7s ease-in-out infinite;
  -moz-transform-origin: 50% 4px;
  //animation: ring 5s .7s ease-in-out infinite;
  transform-origin: 50% 4px;
}

.bell-on{
  display:block;
  width: 140px;
  height: 140px;
  font-size: 140px;
  margin:50px auto 50px auto ;
  color: #9e9e9e;
  -webkit-animation: ring 5s .7s ease-in-out infinite;
  -webkit-transform-origin: 50% 4px;
  -moz-animation: ring 5s .7s ease-in-out infinite;
  -moz-transform-origin: 50% 4px;
  animation: ring 5s .7s ease-in-out infinite;
  transform-origin: 50% 4px;
}

@-webkit-keyframes ring {
  0% { -webkit-transform: rotateZ(0); }
  1% { -webkit-transform: rotateZ(30deg); }
  3% { -webkit-transform: rotateZ(-28deg); }
  5% { -webkit-transform: rotateZ(34deg); }
  7% { -webkit-transform: rotateZ(-32deg); }
  9% { -webkit-transform: rotateZ(30deg); }
  11% { -webkit-transform: rotateZ(-28deg); }
  13% { -webkit-transform: rotateZ(26deg); }
  15% { -webkit-transform: rotateZ(-24deg); }
  17% { -webkit-transform: rotateZ(22deg); }
  19% { -webkit-transform: rotateZ(-20deg); }
  21% { -webkit-transform: rotateZ(18deg); }
  23% { -webkit-transform: rotateZ(-16deg); }
  25% { -webkit-transform: rotateZ(14deg); }
  27% { -webkit-transform: rotateZ(-12deg); }
  29% { -webkit-transform: rotateZ(10deg); }
  31% { -webkit-transform: rotateZ(-8deg); }
  33% { -webkit-transform: rotateZ(6deg); }
  35% { -webkit-transform: rotateZ(-4deg); }
  37% { -webkit-transform: rotateZ(2deg); }
  39% { -webkit-transform: rotateZ(-1deg); }
  41% { -webkit-transform: rotateZ(1deg); }

  43% { -webkit-transform: rotateZ(0); }
  100% { -webkit-transform: rotateZ(0); }
}

@-moz-keyframes ring {
  0% { -moz-transform: rotate(0); }
  1% { -moz-transform: rotate(30deg); }
  3% { -moz-transform: rotate(-28deg); }
  5% { -moz-transform: rotate(34deg); }
  7% { -moz-transform: rotate(-32deg); }
  9% { -moz-transform: rotate(30deg); }
  11% { -moz-transform: rotate(-28deg); }
  13% { -moz-transform: rotate(26deg); }
  15% { -moz-transform: rotate(-24deg); }
  17% { -moz-transform: rotate(22deg); }
  19% { -moz-transform: rotate(-20deg); }
  21% { -moz-transform: rotate(18deg); }
  23% { -moz-transform: rotate(-16deg); }
  25% { -moz-transform: rotate(14deg); }
  27% { -moz-transform: rotate(-12deg); }
  29% { -moz-transform: rotate(10deg); }
  31% { -moz-transform: rotate(-8deg); }
  33% { -moz-transform: rotate(6deg); }
  35% { -moz-transform: rotate(-4deg); }
  37% { -moz-transform: rotate(2deg); }
  39% { -moz-transform: rotate(-1deg); }
  41% { -moz-transform: rotate(1deg); }

  43% { -moz-transform: rotate(0); }
  100% { -moz-transform: rotate(0); }
}

@keyframes ring {
  0% { transform: rotate(0); }
  1% { transform: rotate(30deg); }
  3% { transform: rotate(-28deg); }
  5% { transform: rotate(34deg); }
  7% { transform: rotate(-32deg); }
  9% { transform: rotate(30deg); }
  11% { transform: rotate(-28deg); }
  13% { transform: rotate(26deg); }
  15% { transform: rotate(-24deg); }
  17% { transform: rotate(22deg); }
  19% { transform: rotate(-20deg); }
  21% { transform: rotate(18deg); }
  23% { transform: rotate(-16deg); }
  25% { transform: rotate(14deg); }
  27% { transform: rotate(-12deg); }
  29% { transform: rotate(10deg); }
  31% { transform: rotate(-8deg); }
  33% { transform: rotate(6deg); }
  35% { transform: rotate(-4deg); }
  37% { transform: rotate(2deg); }
  39% { transform: rotate(-1deg); }
  41% { transform: rotate(1deg); }

  43% { transform: rotate(0); }
  100% { transform: rotate(0); }
}
</style>

<template id="mine.html">
  <ons-page id="mine">

<div style="margin-top: 44px; display: none" id="mineLayout">
  <ons-toolbar>
    <div class="center">Mining</div>
  </ons-toolbar>

<br>
<br>
<br>

<div>
  <h1 id="miningBell" >0 BELL</h1>
  <span class="bell-off fa fa-bell" id="bell"></span>
  <h1 id="bellEffect" style="display: none"> + 1</h1>
</div>

</div>

  </ons-page>
</template>

<script type="text/javascript" src="/assets/js/dogedata.js"></script>
<script>
function drawChart() {

  $("#homeLayout").show()
/*
  Hello World
*/
var dojichart = new DojiChart.core.Chart(document.getElementById("my-dojichart"), {
  fieldMap: {
    time: "t",
    open: "o",
    high: "h",
    low: "l",
    close: "c",
  }
});

// Candlestick layer
var candle_layer = new DojiChart.layer.CandleLayer({
  bearBodyColor: "blue",
  bullBodyColor: "red",
});

// Price chart panel
var price_chart_panel = new DojiChart.panel.TimeValuePanel({
  primaryLayer: candle_layer,
  height: 250,
  grid: true,
  //paddingTop : 100
});

dojichart.addComponent("price", price_chart_panel);

if(CHARTTIMER){
    clearInterval(CHARTTIMER);
}

CHARTTIMER = setInterval(function() {

  if (DOGEPRICEFORUSD == 0){
    return
  }
  
  //data_arr = shuffle(data_arr);

  const rand1 = DOGEPRICEFORUSD
  const rand2 = rand1 + 0.03
  const rand3 = rand1 - 0.03;
  var rand4 = rand1 + Math.random() * 0.1;

  if (MOONCOST > 0){
    MOONCOST = MOONCOST * 1.2;
    
    //var maxCost = (DOGEPRICE / DOGEPRICEFORUSD)

    //console.log(maxCost);

    if(MOONCOST > 1){
      MOONCOST = 1
    }
    rand4 = MOONCOST;
  }

  //console.log(rand4 + "!!")


  dogeData.pop()
  dogeData.pop()
  
  var data = {"t":"14-5-2021","o":rand1,"h":rand2,"l":rand3,"c":rand4,"v":100}
  dogeData.push(data)
  
  var data = {"t":"14-5-2021","o":1,"h":1,"l":1,"c":1,"v":100}
  dogeData.push(data)
  
  dojichart.loadData(dogeData, "DOGE", "M5");
}, 300);

/* end of file */

}

var BELLPRICE;
var BELLPRICEFORUSD;
var TOTALMONEY;

var TRADETIMER;
var CHARTTIMER;

function drawTrade() {

  $("#tradeLayout").show()
/*
  Hello World
*/
var dojichart = new DojiChart.core.Chart(document.getElementById("tradeChart"), {
  fieldMap: {
    time: "t",
    open: "o",
    high: "h",
    low: "l",
    close: "c",
  }
});

// Candlestick layer
var candle_layer = new DojiChart.layer.CandleLayer({
  bearBodyColor: "blue",
  bullBodyColor: "red",
});

// Price chart panel
var price_chart_panel = new DojiChart.panel.TimeValuePanel({
  primaryLayer: candle_layer,
  height: 250,
  grid: true,
  //paddingTop : 100
});

dojichart.addComponent("price", price_chart_panel);

if(TRADETIMER){
  clearInterval(TRADETIMER)
}

TRADETIMER = setInterval(function() {

  if (DOGEPRICEFORUSD == 0){
    return
  }
  
  //data_arr = shuffle(data_arr);

  const rand1 = DOGEPRICEFORUSD
  const rand2 = rand1 + 0.03
  const rand3 = rand1 - 0.03;
  var rand4 = rand1 + Math.random() * 0.1

  if(rand4 > 1){
    rand4 = 1
  }

  if(isUpdate == false) {
    $("#bellPrice").html(rand4.toFixed(4))
    //console.log(rand4 + "!!")
    BELLPRICE = rand4.toFixed(4)

    if(!TOTALAMOUNT){
      TOTALAMOUNT = 0
    }

    //console.log(rand4.toFixed(4))
    BELLPRICEFORUSD = rand4.toFixed(4) 

    var totalBell = parseInt(TOTALAMOUNT) + parseInt(MININGBELL)
    var calculatePrice = BELLPRICEFORUSD * (parseInt(TOTALAMOUNT) + parseInt(MININGBELL))

    $("#dogeBellForTrade").html(totalBell)
    $("#calculateForTrade").html(calculatePrice.toFixed(4))

    if(!TOTALMONEY){
      TOTALMONEY = 0
    }

    //console.log(TOTALMONEY)

    $("#moneyForTrade").html(TOTALMONEY.toFixed(4))
  }


  dogeData.shift();
  dogeData.pop()
  
  var data = {"t":"14-5-2021","o":rand1,"h":rand2,"l":rand3,"c":rand4,"v":100}
  dogeData.push(data)

  var data = {"t":"14-5-2021","o":1,"h":1,"l":1,"c":1,"v":100}
  dogeData.push(data)
  dojichart.loadData(dogeData, "DOGE", "M5");
}, 300);

/* end of file */

}

var showWalletAlert = function() {

  var isDialog = $(".dialog-mask").is(':visible');

  if(isDialog){
    //console.log("DIALOG.")
    return
  }

  var dialog = document.getElementById('my-dialog');

  if (dialog) {
    dialog.show();
  } else {
    ons.createElement('dialog.html', { append: true })
      .then(function(dialog) {
        dialog.show();
      });
  }

  QR = getParameterByName("QR")
  if(QR) {
    importWallet()
  }

};

var hideDialog = function(id) {
  document
    .getElementById(id)
    .hide();
};


var showMnemonicDialog = function() {
  
  // var isDialog = $(".dialog-mask").is(':visible');

  // if(isDialog){
  //   //console.log("DIALOG.")
  //   return
  // }

  var dialog = document.getElementById('mnemonicDialog');

  if (dialog) {
    dialog.show();
  } else {
    ons.createElement('mnemonicDialog.html', { append: true })
      .then(function(dialog) {
        dialog.show();

          QR = getParameterByName("QR")
          if(QR) {
            $("#walletInput").val(QR)
          }

      });
  }
};

var showMnemonicBackupDialog = function() {
  var dialog = document.getElementById('mnemonicBackupDialog');

  if (dialog) {
    dialog.show();
  } else {
    ons.createElement('mnemonicBackupDialog.html', { append: true })
      .then(function(dialog) {
        dialog.show();

        MNEMONIC = getParameterByName("MNEMONIC")
        //alert(MNEMONIC)
        var words = MNEMONIC.split(",")
        $("#walletLabel").val(WALLET)
        $("#word1Label").val(words[0])
        $("#word2Label").val(words[1])
        $("#word3Label").val(words[2])
      });
  }
};

var showSendDogeBell = function() {

  var isDialog = $(".dialog-mask").is(':visible');

  if(isDialog){
    //console.log("DIALOG.")
    return
  }

  var dialog = document.getElementById('sendDialog');

  if (dialog) {
    dialog.show();
  } else {
    ons.createElement('sendDialog.html', { append: true })
      .then(function(dialog) {
        dialog.show();

          QR = getParameterByName("QR")
          if(QR) {
            $("#sendWalletInput").val(QR)
          }
      });
  }
};
</script>

<ons-modal direction="up">
  <div style="text-align: center">
    <p>
      <ons-icon icon="md-spinner" size="28px" spin></ons-icon> Loading...
    </p>
  </div>
</ons-modal>

<template id="dialog.html">
  <ons-dialog id="my-dialog" cancelable>
    <div style="text-align: center; padding: 10px;">
      <p>
        You do not have a wallet.
      </p>

      <p >
        <ons-button style="margin: 5px" onClick="createWallet()">Create Wallet.</ons-button> 
        <ons-button style="margin: 5px" onClick="importWallet()">Import Wallet.</ons-button>
      </p>
    </div>
  </ons-dialog>
</template>


<template id="mnemonicDialog.html">
  <ons-dialog id="mnemonicDialog" cancelable>
  <div style="text-align: center; margin : 30px;">

      <p>
      <label>Import Wallet : </label>
      </p>
      <p>
      <ons-input modifier="underbar" placeholder="Wallet Address" id="walletInput"></ons-input>
      </p>
      
      <p>
      <ons-button onClick="goQR()"><ons-icon icon="fa-qrcode"></ons-icon>&#x20;Scan</ons-button>
      </p>

      <p>
      <label>Mnemonic Words : </label>
      </p>
      <p>
        <ons-input id="word1" modifier="underbar" placeholder="Word1"></ons-input>
      </p>
      <p>
        <ons-input id="word2" modifier="underbar" placeholder="Word2"></ons-input>
      </p>
      <p>
        <ons-input id="word3" modifier="underbar" placeholder="Word3"></ons-input>
      </p>
    <p style="margin-top: 30px;">
      <ons-button onClick="createWalletWithMnemonic()"><ons-icon icon="fa-file-import"></ons-icon>&#x20;Import</ons-button>
    </p>
  </div>
  </ons-dialog>
</template>

<template id="mnemonicBackupDialog.html">
  <ons-dialog id="mnemonicBackupDialog" cancelable>
  <div style="text-align: center; margin : 30px;">

      <p>
      <label>Backup Wallet : </label>
      </p>
      <p>
      <ons-input modifier="underbar" placeholder="Wallet Address" id="walletLabel" readonly></ons-input>
      </p>
      <!-- 
      <p>
      <ons-button onClick="goQR()"><ons-icon icon="fa-qrcode"></ons-icon>&#x20;Scan</ons-button>
      </p>
 -->
      <p>
      <label>Mnemonic Words : </label>
      </p>
      <p>
        <ons-input id="word1Label" modifier="underbar" placeholder="Word1" readonly></ons-input>
      </p>
      <p>
        <ons-input id="word2Label" modifier="underbar" placeholder="Word2" readonly></ons-input>
      </p>
      <p>
        <ons-input id="word3Label" modifier="underbar" placeholder="Word3" readonly></ons-input>
      </p>
    <p style="margin-top: 30px;">
      <ons-button onClick="hideDialog('mnemonicBackupDialog')"><ons-icon icon="fa-file-export"></ons-icon>&#x20;OK</ons-button>
    </p>
  </div>
  </ons-dialog>
</template>

<template id="sendDialog.html">
  <ons-dialog id="sendDialog" cancelable>
  <div style="text-align: center; margin : 30px;">

      <p>
      <label>Send DogeBell : </label>
      </p>
      <p>
      <ons-input modifier="underbar" placeholder="Wallet Address" id="sendWalletInput"></ons-input>
      </p>
      
      <p>
      <ons-button onClick="goQR()"><ons-icon icon="fa-qrcode"></ons-icon>&#x20;Scan</ons-button>
      </p>

      <p>
      <label>Send Amount : </label>
      </p>
      <p>
        <ons-input modifier="underbar" placeholder="How much Bell?" id="sendInput"></ons-input>
      </p>
    <p style="margin-top: 30px;">
      <ons-button onClick="sendDogeBell()"><ons-icon icon="fa-paper-plane"></ons-icon>&#x20;Send</ons-button>
    </p>
  </div>
  </ons-dialog>
</template>


<script>
 
function setCookie(name, value, days) {
        if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                var expires = "; expires=" + date.toGMTString();
        } else {
               var expires = "";
        }
        
        document.cookie = name + "=" + value + expires + "; path=/";
}

 
function getCookie(cookieName){
    var cookieValue;
    if(document.cookie){
        var array=document.cookie.split((escape(cookieName)+'='));
        if(array.length >= 2){
            var arraySub=array[1].split(';');
            cookieValue=unescape(arraySub[0]);
        }
    }
    return cookieValue;
}
 
function deleteCookie(cookieName){
    var temp=getCookie(cookieName);
    if(temp){
        setCookie(cookieName,temp,(new Date(1)));
    }
}
 
</script>

</body>
</html>